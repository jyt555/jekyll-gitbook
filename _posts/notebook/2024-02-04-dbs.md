---
title: DBS
author: jyt555
date: 2024-02-04
category: pages/notebook
layout: post
mermaid: true
---

# 。

## Introduction

grading policy:

50 final exam | 30 lab and project | 20 hw and class test

final exam: close book test, but allow taking one handwritten A4 page note

### what should we learn?

* Modeling and design of databases
* Programming: use database - queries and update of data
* `DBMS( Database Management system )` implementation - how does DBMS work, and how to design a DBMS

### what’s a database

<details>
    <summary>Database Definition [click]</summary>
    .<br/>
    A collection of <b>interrelated data</b>, relevant to an enterprise.<br/>
    A large collection of <b>integrated and persistent</b> data.<br/>
    A collection of information that exists over a long period of time, often many years.<br/>
    .
</details>

<details>
	<summary>Database Management System (DBMS) [click]</summary>
    .<br/>
    (Database) + A set of programs used to access, update and manage the data in database.<br/>
    .
</details>

<details>
    <summary>Major properties of DBMS [click]</summary>
    .<br/>
    * <b>Efficiency</b> and <b>scalability</b> (可扩展性) in data access;<br/>
    * <b>Reduced</b> application development time;<br/>
    * Data <b>independence</b> (physical data independence / logical data independence);<br/>
    * Data <b>integrity</b> (完整性) and security;<br/>
    * <b>Concurrent access</b> and <b>robustness</b> (recovery).<br/>
    .
</details>

### DBMS

- a historical perspective
- database systems VS file processing systems
- marketplace

### Levels of Data Abstraction

How to use DB - Different usage needs different level of **abstraction.** 
(e.g., student score management system)

* Physical level: describes how a record is stored.
* Logical level: describes data stored in database, and the relationships among the data on upper level.
* View level: application programs hide details of data types. Views can also hide information.

`Schemas (模式) and Instances (实例)`

Similar to types (schema) and variables (instance) in programming languages

* Schema: the **structure of the database on different level**
* Instance: the actual **content** of the database at a particular point in time

![](../../assets/notebook/Snipaste_2024-03-01_15-24-15.png)

### Data Models

<details>
    <summary>Data model - A collection of conceptual tools for describing [click]</summary>
    .<br/>
    data structure, data relationships, data semantics (语义), data constraints<br/>
    .
</details>

<details>
    <summary>Different data models [click]</summary>
    .<br/>
    Entity-Relationship model, Relational model, object-oriented model. semi-structured data model(XML)…<br/>
    .
</details>

<details>
    <summary>6 Steps of Database Design [click]</summary>
    .<br/>
    Requirement analysis<br/>
    Conceptual database design<br/>
    Logical database design<br/>
    Schema refinement<br/>
    Physical database design<br/>
    Create and initialize the database.Security design<br/>
    .
</details>

### Database Language

#### Data Definition Language (DDL,数据定义语言)

* Specifies a **database scheme** as a set of definitions of **relational schema**.
* Also specifies **storage structure, access methods and consistency constraints.**
* DDL statements are compiled, resulting in a set of tables stored in a special file: **data dictionary** (数据字典), which contains metadata (元数据).

#### Data Manipulation Language (DML,数据操纵语言)

DML (alse known as query language):

**Retrieve**(检索) data from the database, **Insert / delete / update** data in the database 

Two classes of languages: Procedural and **Non**procedural (user specifies what data is required **without** specifying how to get those data e.g. SQL, Prolog)

#### Data Control Language (DCL,数据控制语言)

#### Structured Query Language (SQL,结构化查询语言)

SQL = DDL + DML + DCL, it’s the most widely used query language.

### Database Users

### Database Administrator (DBA)

### Transaction Management (事务管理)

**Transaction requirement: ACID**

atomicity ( 原子性), consistence (一致性), isolation (隔离性), durability ( 持久性)

### Database management system structure

---

## Relational Model

### What is relational model

* The relational model is very simple and elegant.
* A `relational database` is a collection of one or more `relations`, which are based on relational model.
* A relation is a **table** with **rows and columns.**
* The major advantages of the relational model are its simple data representation and the ease with which even complex queries can be expressed.
* Owing to the great language SQL, the most widely used language for creating, manipulating, and querying relational database.

| A **relationship** (联系): an association among several **entities**. |

| A **relation**(关系): is the mathematical concept, referred to a **table**. |

### Basic Structure

A relation *r* is a subset of $D_1\times D_2\times \dots \times D_n$, a Cartesian product (笛卡尔积) of a list of domain $D_i$.

Thus a relation is a set of n-tuples $(a_{1j},\;a_{2j},\;\dots ,\;a_{nj})$

#### Attribute Types (属性类型)

* Each attribute of a relation has a name
* The set of allowed values for each attribute is called the **domain** of the attribute
* `Attribute values` are (normally) required to be **atomic**, that is, indivisible (1st NF，第一范式)
* The special value **null** is a member of every domain
* The **null** value causes complications in the definition of many operations

#### Concepts about relation

A relation is concerned with two concepts: 

* `relation schema 模式`: describe the structure of the relation
* `relation instance 实例`: corresponds to the snapshot of the data in the relation at a given instant in time

|    variable    |     relation      |
| :------------: | :---------------: |
| variable type  |  relation schema  |
| variable value | relation instance |

#### Relations are Unordered

**Order of tuples is irrelevant** (tuples may be stored in an arbitrary order), and tuples in a relation are no duplicate.

#### Keys (码，键)

![](../../assets/notebook/Snipaste_2024-03-04_15-27-43.png)

#### Foreign Key (外键，外码)

![](../../assets/notebook/Snipaste_2024-03-05_19-24-19.png)

#### Query Languages:star:

* Language in which user requests information from the database
* “Pure” languages:
  * Relational Algebra - the basis of SQL
  * Tuple Relational Calculus (元组关系演算)
  * Domain Relational Calculus (域关系演算) - QBE
* Pure languages form underlying basis of query languages that people use

### Relational Algebra

* Procedural language (in some extent)

* Six basic operators

  |          operator          |             notation             |                      example                      |
  | :------------------------: | :------------------------------: | :-----------------------------------------------: |
  |        select 选择         |          $\sigma_P(r)$           |   $\sigma_{dept\_ name='Finance'}(department)$    |
  |        Project 投影        |  $\Pi_{A_1,A_2,\dots ,A_k}(r)$   |           $\Pi_{building}(department)$            |
  |          Union 并          |            $r\cup s$             | $\Pi_{name}(instructor)\cup \Pi_{name}(student)$  |
  |     set difference 差      |              $r-s$               |          (between compatible relations)           |
  | Cartesian product 笛卡尔积 |           $r\times s$            | ($R\cap S=\varnothing$ or rename the attributes)  |
  |       Rename 重命名        | $\rho_{X(A_1,A_2,\dots,A_n)}(E)$ | ($E\rightarrow X,attributes\rightarrow A_1\dots$) |

* The operators take one or two relations as inputs and give a new relation as a result.

  ![](../../assets/notebook/Snipaste_2024-03-07_01-05-02.png)

* Additional operations

|       operator        |                           notation                           |                   example                   |
| :-------------------: | :----------------------------------------------------------: | :-----------------------------------------: |
|  Set intersection 交  |                          $r\cap s$                           |             ($r\cap s=r-(r-s)$)             |
| Natural join 自然连接 | <img src="../../assets/notebook/Snipaste_2024-03-07_01-28-20.png" style="zoom:35%;" /> |                :point_down:                 |
|      Division 除      |                          $r$ ÷ $s$                           |                :point_down:                 |
|    Assignment 赋值    |                       $r\leftarrow s$                        | (be  made to a temporary relation variable) |

![](../../assets/notebook/Snipaste_2024-03-07_16-31-32.png)

![](../../assets/notebook/Snipaste_2024-03-09_01-02-11.png)

![](../../assets/notebook/Snipaste_2024-03-07_16-54-04.png)

`Priority`:

$Project\rightarrow Select\rightarrow Cartesian\;Product\rightarrow Join,division\\\rightarrow Intersection\rightarrow Union,difference$

> ##### 区别笛卡尔积和自然连接
>
> 做笛卡尔积时，attribute不同名（满足条件空集）或是需要在新的关系中重命名（如r.B和s.B，满足条件重命名）；做自然连接时，attribute必须有同名的部分（作为连接桥梁）。
>
{: .block-warning}

### Extended Relational-Algebra-Operations

| operator                        |         notation          |                           example                            |
| ------------------------------- | :-----------------------: | :----------------------------------------------------------: |
| Generalized Projection 广义投影 | $\Pi_{F1,F2,\dots,Fn}(E)$ | $\Pi_{customer-name,\;limit\;-\;credit-balance}(credit-info)$ |
| Aggregate Functions 聚集函数    | avg, min, max, sum. count |            $g_{avg(balance)}(accou)$ :point_down:            |
| Outer Join 外连接               |       :point_down:        |                         :point_down:                         |

![](../../assets/notebook/Snipaste_2024-03-08_14-12-33.png)

![](../../assets/notebook/Snipaste_2024-03-08_14-31-35.png)

![](../../assets/notebook/Snipaste_2024-03-08_16-22-25.png)

![](../../assets/notebook/Snipaste_2024-03-08_16-22-52.png)

![](../../assets/notebook/Snipaste_2024-03-08_16-23-40.png)

* **Null Values**: *null* signifies an unknown value or that a value does NOT exist, and the result of any arithmetic expression involving *null* is null (so aggregate functions simply ignore null values)

![](../../assets/notebook/Snipaste_2024-03-08_22-53-37.png)

### Modification of the Database

| operator  |               notation               |                           example                            |
| :-------: | :----------------------------------: | :----------------------------------------------------------: |
| Deletion  |          $r \leftarrow r-E$          | $account\leftarrow account-\sigma_{branch-name="xxx"}(account)$ |
| Insertion |        $r\leftarrow r\cup E$         | $account \leftarrow account\cup \{ ("Perry",A-973,1200) \}$  |
| Updating  | $r\leftarrow \Pi_{F1,F2\dots,Fn}(r)$ |      $account\leftarrow \Pi_{AN,BN,BAL*1.05}(account)$       |

